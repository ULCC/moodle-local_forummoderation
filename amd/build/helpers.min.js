define("local_forummoderation/helpers",["exports","./strings","./services","jquery","core/modal_factory"],(function(_exports,_strings,_services,_jquery,_modal_factory){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * AMD module used when managing enterprise customfields.
   *
   * @module      local_forummoderation
   * @copyright   2024 Yahya (yahya@teruselearning.co.uk)
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   * */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_strings=_interopRequireDefault(_strings),_services=_interopRequireDefault(_services),_jquery=_interopRequireDefault(_jquery),_modal_factory=_interopRequireDefault(_modal_factory);class Helpers{createSpinner(classname){const spinner=document.createElement("div");return spinner.className=classname,spinner}async checkForumPostUser(postId){return new Promise((resolve=>{new _services.default(_jquery.default.ajax).checkForumPostUser(postId,(res=>{resolve(JSON.parse(res).data)}))}))}async modalNotification(){const strings=new _strings.default,title=await strings.get("message:alertreported_title"),message=await strings.get("message:alertreported_desc"),alert=(new Helpers).createAlert("",title,message),titlemodal=await strings.get("message:modal_title");return await _modal_factory.default.create({title:titlemodal,body:alert,footer:"Footer"},(0,_jquery.default)("a.item-delete"))}async createLinkReportModerator(user){let postActionDivs=document.querySelectorAll("div.post-actions");if(null!==localStorage.getItem("success")){(await this.modalNotification()).show()}localStorage.removeItem("success"),postActionDivs.forEach((async postActionDiv=>{let allLinks=postActionDiv.querySelectorAll("a");var linksWithDataPostId=Array.from(allLinks).filter((function(link){return link.hasAttribute("data-post-id")}));if(linksWithDataPostId.length>0){var postId=linksWithDataPostId[0].getAttribute("data-post-id");const forumPostUserData=await this.checkForumPostUser(postId);var newLink=document.createElement("a");newLink.href="#",newLink.classList.add("btn","btn-link"),newLink.textContent="Report to moderator",newLink.setAttribute("data-action","forummoderation-reportpost"),newLink.setAttribute("data-post-id",postId);const reported_by=forumPostUserData.reported_by?forumPostUserData.reported_by:0;newLink.setAttribute("data-reported",reported_by);const useridpost=parseInt(forumPostUserData.useridpost);parseInt(user)!=useridpost&&postActionDiv.insertBefore(newLink,postActionDiv.firstChild)}}))}createAlert(type,title,message){var alertDiv=document.createElement("div");alertDiv.className="alert "+type,alertDiv.setAttribute("role","alert");var heading=document.createElement("h4");heading.className="alert-heading",heading.textContent=title,alertDiv.appendChild(heading);var mainContent=document.createElement("p");mainContent.textContent=message,alertDiv.appendChild(mainContent),alertDiv.appendChild(document.createElement("hr"));var button=document.createElement("button");return button.setAttribute("type","button"),button.classList.add("btn","btn-ok-forummoderation"),button.textContent="Ok",button.setAttribute("data-action","hide"),alertDiv.appendChild(button),alertDiv}}var _default=Helpers;return _exports.default=_default,_exports.default}));

//# sourceMappingURL=helpers.min.js.map